<html>
<div id="result" style="font-size: large"></div>
<script>

function generate_new_practice()
{
  var scales = ["G Major @ 69",
                "A-flat Major @ 69",
                "D Major @ 69",
                "D-flat Major @ 69",
                "E Minor Harmonic @ 69",
                "F Minor Harmonic @ 69",
                "B Minor Harmonic @ 69",
                "B-flat Minor Harmonic @ 69"];
  var scale = scales[Math.floor(Math.random() * scales.length)];

  var note_values = ["triplet", "16th note"];
  var note_value = note_values[Math.floor(Math.random() * note_values.length)];

  var strokes = ["Rest Stroke", "Free Stroke"];
  var stroke  = strokes[Math.floor(Math.random() * strokes.length)];

  var fingerings = ["im", "ma", "ia"];
  var fingering = fingerings[Math.floor(Math.random() * fingerings.length)];

  var arpeggios = ["p-i-m-a ascending @ 76",
                   "p-a-m-i descending @ 76",
                   "p-i-m-i pattern @ 76",
                   "p-m-i-m pattern @ 76",
                   "ascending and descending sextuplet @ 52",
                   "descending and ascending sextuplet @ 52",
                   "p-a dyad-m-i triplet pattern @ 76",
                   "p-i dyad-m-a triplet pattern @ 76",
                   "p-m dyad-i-a triplet pattern @ 76",
                   "p-i dyad-a-m triplet pattern @ 76"];

  var arpeggio = arpeggios[Math.floor(Math.random() * arpeggios.length)];

  var pieces = ["Bach Minuet", "Paganini Minuet", "Spanish Romance"];
  var piece = pieces[Math.floor(Math.random() * pieces.length)];

  var studies = ["Carcassi Tremolo Study", "Bosch Lamento"];
  var study = studies[Math.floor(Math.random() * studies.length)];

  return "<ol>" +
         "<li>" + scale + ", " + note_value + ", " + stroke + ", " + fingering + "</li>" +
         "<li>" + arpeggio + "</li>" +
         "<li>" + piece + "</li>" +
         "<li>" + study + "</li>" +
         "</ol>";
}

cached_practice = localStorage.getItem("cached_practice")
cached_practice_date = localStorage.getItem("cached_practice_date")

var today = new Date().getDate();

// if we can use a cached practice, then do so
if (cached_practice != null &&
    cached_practice_date == today)
{
  document.getElementById("result").innerHTML = cached_practice;
}
// otherwise create a new one and save it
else
{
  new_practice = generate_new_practice();
  document.getElementById("result").innerHTML = new_practice;
  localStorage.setItem("cached_practice", new_practice);
  localStorage.setItem("cached_practice_date", today);
}

</script>
</html>
